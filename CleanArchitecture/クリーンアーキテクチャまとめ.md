# クリーンアーキテクチャまとめ

## クリーンアーキテクチャとは

クリーンアーキテクチャとは、ロバート・C. マーチン(Uncle Bob)によって提唱されたソフトウェアの設計原則の一つです。
「関心の分離」を行い、ソフトウェアの保守性や拡張性を高めることを目的としています。

[The Clean Architecture](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)

[The Clean Architecture 翻訳](https://blog.tai2.net/the_clean_architecture.html)

## クリーンアーキテクチャのメリット

クリーンアーキテクチャのメリットは主に下記の 2 つになります。

- フレームワーク、UI、DB、外部機能の独立
- 外部の要素(UI、データベース、ウェブサーバー)なしにテスト可能

「関心の分離」によってビジネスルールの変更なしに DB を MySQL から Mongo に交換したり、UI を Web UI からコンソール UI に置き換えることができます。

また、ビジネスルールは、UI、データベース、ウェブサーバー、その他外部の要素なしにテスト可能になります。

## クリーンアーキテクチャの構成

クリーンアーキテクチャは下の図のように大きく分けて 4 つの階層に別れます。

※コンセプトの説明ため 4 つに別れているため、4 つでなければいけないという決まりはありません。

![CleanArchitecture](./img/CleanArchitecture.jpg)

クリーンアーキテクチャの構成で重要なことは依存関係のルールです。内側に向かってのみ依存することができます。内側の円は、外側の円についてなにも知ることはありません。

## 各階層の責務

1. エンティティ層 (Entities)

   責務: ビジネスの核心となるデータとルールを定義します。(アプリケーションに依らないビジネスルール)

   説明: エンティティ層は、アプリケーションが扱うビジネスオブジェクトやビジネスルールを表現します。例えば、顧客、注文、商品などのデータ構造や、それに関連するビジネスロジックをここで定義します。

2. ユースケース層 (Use Cases)
   責務: アプリケーションのユースケース（ビジネスプロセスや機能）を定義し、それを実行するためのロジックを提供します。(アプリケーション的なビジネスルール)

   説明: ユースケース層は、ユーザーがアプリケーションをどのように使うか（例えば、商品を購入する、注文をキャンセルする）を定義します。この層は、エンティティ層が提供するビジネスルールを使って、アプリケーションがどのように動作するかをコントロールします。ユーザーからの入力を受け取り、それに基づいてエンティティ層のデータを操作します。

3. インターフェース層 (Interface Adapters)
   責務: ユースケース層と外部との接続を担当し、外部とのデータのやり取りを行います。

   説明: インターフェース層は、アプリケーションの内部ロジックと外部機能（UI や BB、外部 API など）との橋渡しをします。この層には、コントローラー、データベースアクセスのためのリポジトリなどが含まれます。データを内部のビジネスロジックが理解できる形式に変換し、またその逆も行います。

4. フレームワークとドライバ層 (Frameworks and Drivers)
   責務: 外部のフレームワークやライブラリ、ドライバを扱い、システムと外部とのインターフェースを提供します。

   説明: この層は、具体的な技術スタックやツール（例えば、ウェブフレームワーク、データベース管理システム、外部サービスなど）を扱います。これには、HTTP リクエストやデータベースクエリの処理、外部システムとの接続設定などが含まれます。
